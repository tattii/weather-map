{"version":3,"sources":["BaseLayer.js","weather-map-front.js","weather-map-layer.js","satellite.js","WeatherMap.js","Map.js","App.js","index.js"],"names":["BaseLayer","constructor","map","this","addSource","addLayer","WeatherMapFront","geojson","add","split","features","filter","f","properties","type","includes","reduce","concat","data","turf","segment","chunks","i","Object","assign","z","addFront","id","offset","width","WeatherMapLayer","onSelected","hover","e","queryRenderedFeatures","point","layers","layerId","html","getCanvas","style","cursor","length","code","popup","setLngLat","lngLat","setHTML","addTo","remove","addMap","render","analysis","url","mapboxgl","Popup","closeButton","on","removeLayer","off","fetch","mode","res","json","forEach","pressure","isobar","addIsobar","front","addSymbols","dash","paint","addLabel","label","color","Satellite","then","console","log","index","d","basetime","validtime","tiles","minzoom","maxzoom","addLayerJP","bouds","Warning","Component","state","componentDidMount","props","load","componentWillUnmount","layer","onload","timestamp","Date","getTime","setState","satellit","accessToken","component","WeatherMap","name","icon","Map","layerIndex","selectLayer","container","mapContainer","zoom","center","hash","logoPosition","attributionControl","base","child","className","ref","el","renderLayer","React","createElement","App","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.746e6ee2.chunk.js","sourcesContent":["\nexport default class BaseLayer {\n  constructor(map) {\n    this.map = map;\n    this.map.addSource(\"vt\", {\n      \"type\": \"vector\",\n      \"minzoom\": 0,\n      \"maxzoom\": 10,\n      \"tiles\": [\"https://weatherbox.github.io/warning-area-vt/v2/{z}/{x}/{y}.pbf\"]\n    });\n\n    this.map.addLayer({\n      \"id\": \"pref-line\",\n      \"type\": \"line\",\n      \"source\": \"vt\",\n      \"source-layer\": \"pref\",\n      \"paint\": {\n        \"line-color\": \"rgba(70, 70, 70, 0.4)\"\n      }\n    });\n  }\n}\n","import * as turf from '@turf/turf';\n\nexport default class WeatherMapFront {\n  constructor(map, geojson) {\n    this.map = map;\n    this.add(geojson);\n  }\n\n  add(geojson) {\n    const front = geojson.features.filter(f => f.properties.type.includes('前線'));\n    const split = front.reduce((features, f) => {\n      return features.concat(this.split(f).features);\n    }, []);\n    \n    this.map.addSource('weathermap-front', {\n      type: 'geojson',\n      data: turf.featureCollection(split)\n    });\n    this.addLayer();\n  }\n\n  split(f) {\n    const segment = f.properties.type === '停滞前線' ? 450 : 360; // km\n    const chunks = turf.lineChunk(f, segment);\n    for (let i in chunks.features) {\n      chunks.features[i].properties = Object.assign({}, f.properties);\n      if (turf.length(chunks.features[i]) < 100) {\n        chunks.features[i].properties.z = 10;\n      }\n    }\n    return chunks;\n  }\n\n  addLayer() {\n    this.addFront('cold', '寒冷前線', -8);\n    this.addFront('warm', '温暖前線', 5);\n    this.addFront('stationary', '停滞前線', -3);\n    this.addFront('occuluded', '閉塞前線', 7);\n  }\n  \n  addFront(id, type, offset, width) {\n    this.map.addLayer({\n      \"id\": \"front-symbol-\" + id,\n      \"type\": \"symbol\",\n      \"source\": \"weathermap-front\",\n      \"minzoom\": 3.0,\n      \"layout\": {\n        \"icon-image\": \"front2-\" + id,\n        \"icon-size\": [\n          'interpolate',\n          ['exponential', 1.0],\n          ['zoom'],\n          3, 0.6,\n          8, 1.6\n        ],\n        \"symbol-placement\": \"line-center\",\n        \"symbol-spacing\": 100,\n        \"icon-offset\": [0, offset],\n        \"icon-rotate\": 180,\n      },\n      \"filter\": [\"all\",\n        [\"==\", \"type\", type],\n        [\"!=\", \"z\", 10]\n      ]\n    });\n  }\n}\n","import mapboxgl from 'mapbox-gl';\n\nimport WeatherMapFront from './weather-map-front';\n\nexport default class WeatherMapLayer {\n  constructor(map, data, onSelected) {\n    this.map = map;\n    this.data = data;\n    this.onSelected = onSelected;\n    this.layerId = 'weather-map';\n\n    this.addMap();\n  }\n\n  addMap() {\n    this.render();\n    this.addLayer(this.data.analysis[0].url);\n    //this.addLayer('https://storage.googleapis.com/weather-map/analysis/202006280000.geojson');\n\n    this.popup = new mapboxgl.Popup({\n      closeButton: false\n    });\n    this.map.on('mousemove', this.hover);\n  }\n\n  remove() {\n    this.map.removeLayer(this.layerId);\n    this.map.off('mousemove', this.hover);\n    this.popup.remove();\n  }\n\n  render() {\n  }\n  \n  async addLayer(url) {\n    const res = await fetch(url, { mode: 'cors' });\n    const geojson = await res.json();\n    //console.log(geojson);\n\n    geojson.features.forEach((f, i) => {\n      if (f.properties.type === 'isobar') {\n        if (f.properties.pressure % 20 === 0) {\n          geojson.features[i].properties.isobar = '20hPa';\n        } else if (f.properties.pressure % 4 === 0) {\n          geojson.features[i].properties.isobar = '4hPa';\n        } else if (f.properties.pressure % 2 === 0) {\n          geojson.features[i].properties.isobar = '2hPa';\n        }\n      }\n    });\n    this.map.addSource('weathermap', {\n      type: 'geojson',\n      data: geojson\n    });\n\n    this.addIsobar('2hPa', 0.75, [10, 5]);\n    this.addIsobar('4hPa', 0.75);\n    this.addIsobar('20hPa', 1.5);\n\n    \n    this.front = new WeatherMapFront(this.map, geojson);\n    this.map.addLayer({\n      \"id\": \"front\",\n      \"type\": \"line\",\n      \"source\": \"weathermap\",\n      \"paint\": {\n        \"line-width\": 4,\n        \"line-color\": [\n          \"match\",\n          [\"get\", \"type\"],\n          \"寒冷前線\", \"#1437B1\",\n          \"温暖前線\", \"#7A1C1C\",\n          \"停滞前線\", \"#39144C\",\n          \"閉塞前線\", \"#39144C\",\n          /* default */ \"#000\"\n        ]\n      },\n      \"filter\": [\"in\", \"type\", \"寒冷前線\", \"温暖前線\", \"停滞前線\", \"閉塞前線\"]\n    });\n   \n   this.addSymbols();\n  }\n\n  addIsobar(type, width, dash) {\n    const paint = {\n      \"line-color\": \"#ccc\",\n      \"line-opacity\": 0.3,\n      \"line-width\": width\n    };\n    if (dash) paint['line-dasharray'] = dash;\n    this.map.addLayer({\n      \"id\": \"isobar-\" + type,\n      \"type\": \"line\",\n      \"source\": \"weathermap\",\n      \"paint\": paint,\n      \"filter\": [\"all\",\n        [\"==\", \"type\", \"isobar\"],\n        [\"==\", \"isobar\", type]\n      ]\n    });\n  }\n  \n  addSymbols() {\n    this.map.addLayer({\n      \"id\": \"symbol\",\n      \"type\": \"symbol\",\n      \"source\": \"weathermap\",\n      \"layout\": {\n        \"icon-image\": \"center\",\n        \"icon-size\": 0.6,\n        \"icon-allow-overlap\": true\n      },\n      \"paint\": {\n        \"icon-opacity\": 0.7\n      },\n      filter: [\"in\", \"type\", \"低気圧\", \"高気圧\", \"熱帯低気圧\", \"台風\"]\n    });\n    \n    this.map.addLayer({\n      \"id\": \"symbol-pressure\",\n      \"type\": \"symbol\",\n      \"source\": \"weathermap\",\n      \"minzoom\": 3.0,\n      \"layout\": {\n        \"text-field\": \"{pressure}\",\n        \"text-size\": 12,\n        \"text-font\": [\"DIN Pro Regular\"],\n        \"text-offset\": [0, 1.4]\n      },\n      \"paint\": {\n        \"text-color\": \"rgba(255, 255, 255, 0.8)\"\n      },\n      filter: [\"in\", \"type\", \"低気圧\", \"高気圧\", \"熱帯低気圧\"]\n    });\n\n    this.addLabel('低気圧', 'L', '#7A1C1C');\n    this.addLabel('高気圧', 'H', '#1437B1');\n    this.addLabel('熱帯低気圧', 'TD', '#7A1C1C');\n  }\n\n  addLabel(type, label, color) {\n    this.map.addLayer({\n      \"id\": \"symbol-\" + label,\n      \"type\": \"symbol\",\n      \"source\": \"weathermap\",\n      \"layout\": {\n        \"text-field\": label,\n        \"text-size\": 20,\n        \"text-font\": [\"DIN Pro Bold\"],\n        \"text-offset\": [0, -1.0]\n      },\n      \"paint\": {\n        \"text-color\": color,\n        \"text-halo-color\": \"rgba(255, 255, 255, 0.4)\",\n        \"text-halo-width\": 1\n      },\n      filter: [\"==\", \"type\", type]\n    });\n  }\n\n\n  hover = (e) => {\n    const features = this.map.queryRenderedFeatures(e.point, { layers: [this.layerId] });\n    this.map.getCanvas().style.cursor = (features.length) ? 'crosshair' : '';\n\n    let html;\n    if (features.length) {\n      const code = features[0].properties.code;\n      html = code;\n    }\n    \n    if (html) {\n      this.popup.setLngLat(e.lngLat)\n        .setHTML(html)\n        .addTo(this.map);\n    } else {\n      this.popup.remove();\n    }\n  }\n}\n","export default class Satellite {\n  constructor(map) {\n    this.map = map;\n    this.add();\n  }\n\n  add() {\n    fetch('https://dkve47d2tju8b.cloudfront.net/omaad/rsmc_nowcast/en/jmatile/data/hcai/targetTimes.json', { mode: 'cors' })\n      .then(res => { console.log(res); return res.json(); })\n      .then(data => {\n        this.index = data;\n        this.addLayer(data[0]);\n      });\n  }\n\n  \n  addLayer(d) {\n    const url = 'https://www.data.jma.go.jp/tile/satimg/' + d.basetime + '/fd/' + d.validtime + '/B13/TBB/{z}/{x}/{y}.png';\n    this.map.addSource('satellite', {\n      type: 'raster',\n      tiles: [url],\n      minzoom: 1,\n      maxzoom: 6,\n      //bouds: [119, 19, 155, 51]\n    });\n\n   this. map.addLayer({\n      \"id\": \"satellite\",\n      \"type\": \"raster\",\n      \"source\": \"satellite\",\n      \"paint\": {\n        \"raster-opacity\": 0.3\n      }\n    }, \"isobar-2hPa\");\n  }\n  \n  addLayerJP(d) {\n    const url = 'https://www.data.jma.go.jp/tile/satprod/' + d.basetime + '/JP/' + d.validtime + '/B13/TBB/{z}/{x}/{y}.png';\n    this.map.addSource('satellite', {\n      type: 'raster',\n      tiles: [url],\n      minzoom: 3,\n      maxzoom: 7,\n      bouds: [119, 19, 155, 51]\n    });\n  }\n}\n","import { Component } from 'react';\n\nimport WeatherMapLayer from './weather-map-layer';\nimport Satellite from './satellite';\n\nconst url = 'https://storage.googleapis.com/weather-map/weather-map.json';\n\nexport default class Warning extends Component {\n  state = {\n    data: null,\n  };\n\n  componentDidMount() {\n    this.map = this.props.map;\n    this.load();\n  }\n\n  componentWillUnmount() {\n    this.layer.remove();\n  }\n\n  onload(map) {\n    this.map = map;\n    this.addLayer();\n  }\n  \n  load() {\n    const timestamp = new Date().getTime();\n    fetch(url + '?' + timestamp, { mode: 'cors' })\n      .then(res => res.json())\n      .then(data => {\n        console.log(data);\n        this.setState({ data });\n        this.data = data;\n        this.addLayer();\n      });\n  }\n\n  addLayer() {\n    if (!this.map || !this.data) return;\n    this.layer = new WeatherMapLayer(this.map, this.data, this.onSelected);\n    this.satellit = new Satellite(this.map);\n  }\n\n  render() {\n    return null;\n  }\n}\n","import React, { Component } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport 'mapbox-gl/dist/mapbox-gl.css'\n\nimport BaseLayer from './BaseLayer';\nimport './Map.css';\n\nimport WeatherMap from './WeatherMap';\n\nmapboxgl.accessToken = 'pk.eyJ1IjoidGF0dGlpIiwiYSI6ImNqZWZ4eWM3NTI2cGszM2xpYXEyZndpd3IifQ.ifzbR45HecVGxChbdR2hiw';\n\nconst layers = [\n  {\n    id: 'weather-map',\n    component: WeatherMap,\n    name: '天気図',\n    icon: 'warning sign'\n  },\n];\n\n\nexport default class Map extends Component {\n  state = { layerIndex: 0 };\n\n  componentDidMount() {\n    this.map = new mapboxgl.Map({\n      container: this.mapContainer,\n      style: 'mapbox://styles/tattii/ckc0b6ks64uks1io9nljrkbhs',\n      zoom: 4.2,\n      center: [136.6, 35.5],\n      hash: true,\n      logoPosition: 'bottom-right',\n      attributionControl: false\n    });\n\n    this.map.on('load', () => {\n      this.base = new BaseLayer(this.map);\n      this.child.onload(this.map);\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"app\">\n        <div ref={el => this.mapContainer = el} id=\"map\" />\n        {this.renderLayer()}\n      </div>\n    )\n  }\n\n  renderLayer() {\n    const props = {\n      map: this.map,\n      ref: ref => this.child = ref,\n    };\n    return React.createElement(layers[this.state.layerIndex].component, props);\n  }\n\n  selectLayer = (index) => {\n    this.setState({ layerIndex: index });\n  }\n}\n","import React, { Component } from 'react';\n\nimport Map from './Map';\n\nclass App extends Component {\n  render() {\n    return (\n      <Map />\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('app'));\n\n"],"sourceRoot":""}